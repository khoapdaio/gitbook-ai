# 714. Best Time to Buy and Sell Stock with Transaction Fee

## **â“ Problem**

ğŸ”— [Leetcode: 714. Best Time to Buy and Sell Stock with Transaction Fee](https://leetcode.com/problems/best-time-to-buy-and-sell-stock-with-transaction-fee)

## **ğŸ“ MÃ´ táº£**

Báº¡n Ä‘Æ°á»£c cho má»™t máº£ng `prices[]` trong Ä‘Ã³ `prices[i]` lÃ  giÃ¡ cá»§a má»™t cá»• phiáº¿u vÃ o ngÃ y thá»© `i`. Báº¡n cÅ©ng Ä‘Æ°á»£c cho má»™t sá»‘ `fee`, Ä‘áº¡i diá»‡n cho phÃ­ giao dá»‹ch khi bÃ¡n cá»• phiáº¿u.

Báº¡n cÃ³ thá»ƒ mua vÃ  bÃ¡n nhiá»u láº§n, nhÆ°ng má»—i láº§n bÃ¡n pháº£i cÃ³ phÃ­ `fee`.\
TÃ¬m lá»£i nhuáº­n tá»‘i Ä‘a cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c.

***

## **ğŸ’¡ VÃ­ dá»¥**

#### âœ… VÃ­ dá»¥ 1:

**Input:**

```plaintext
prices = [1,3,2,8,4,9], fee = 2
```

**Output:**

```plaintext
8
```

**Giáº£i thÃ­ch:**

* Mua á»Ÿ giÃ¡ `1`, bÃ¡n á»Ÿ giÃ¡ `8`, lá»£i nhuáº­n: `8 - 1 - 2 = 5`
* Mua á»Ÿ giÃ¡ `4`, bÃ¡n á»Ÿ giÃ¡ `9`, lá»£i nhuáº­n: `9 - 4 - 2 = 3`
* Tá»•ng lá»£i nhuáº­n = `5 + 3 = 8`

***

#### âœ… VÃ­ dá»¥ 2:

**Input:**

```plaintext
prices = [1,3,7,5,10,3], fee = 3
```

**Output:**

```plaintext
6
```

***

## **ğŸš€ Giáº£i phÃ¡p: Quy hoáº¡ch Ä‘á»™ng (Dynamic Programming)**

ChÃºng ta sá»­ dá»¥ng hai tráº¡ng thÃ¡i:

* `hold[i]`: Lá»£i nhuáº­n tá»‘i Ä‘a khi giá»¯ cá»• phiáº¿u vÃ o ngÃ y `i`.
* `cash[i]`: Lá»£i nhuáº­n tá»‘i Ä‘a khi khÃ´ng giá»¯ cá»• phiáº¿u vÃ o ngÃ y `i`.

**CÃ´ng thá»©c quy hoáº¡ch Ä‘á»™ng:**

$$
hold[i] = \max(hold[i-1], cash[i-1] - prices[i])
$$

$$
cash[i] = \max(cash[i-1], hold[i-1] + prices[i] - fee)
$$

## **ğŸ“œ Code**

{% tabs %}
{% tab title="C++" %}
```cpp
class Solution {
public:
    int maxProfit(vector<int>& prices, int fee) {
        int n = prices.size();
        int hold = -prices[0], cash = 0;

        for (int i = 1; i < n; i++) {
            hold = max(hold, cash - prices[i]);
            cash = max(cash, hold + prices[i] - fee);
        }
        return cash;
    }
};
```
{% endtab %}

{% tab title="Java" %}
```java
class Solution {
    public int maxProfit(int[] prices, int fee) {
        int hold = -prices[0], cash = 0;

        for (int i = 1; i < prices.length; i++) {
            hold = Math.max(hold, cash - prices[i]);
            cash = Math.max(cash, hold + prices[i] - fee);
        }
        return cash;
    }
}
```
{% endtab %}

{% tab title="Python" %}
```python
class Solution:
    def maxProfit(self, prices: List[int], fee: int) -> int:
        hold, cash = -prices[0], 0

        for price in prices[1:]:
            hold = max(hold, cash - price)
            cash = max(cash, hold + price - fee)

        return cash
```
{% endtab %}
{% endtabs %}

***

## **ğŸ¯ Äiá»ƒm chÃ­nh**

* DÃ¹ng **quy hoáº¡ch Ä‘á»™ng**, lÆ°u hai tráº¡ng thÃ¡i `hold` (giá»¯ cá»• phiáº¿u) vÃ  `cash` (khÃ´ng giá»¯ cá»• phiáº¿u).
* **Chá»‰ cáº§n biáº¿n `hold` vÃ  `cash`**, tá»‘i Æ°u khÃ´ng gian `O(1)`.
* Quyáº¿t Ä‘á»‹nh bÃ¡n chá»‰ xáº£y ra náº¿u lá»£i nhuáº­n vÆ°á»£t quÃ¡ `fee`.

***

## **â³ Äá»™ phá»©c táº¡p**

| Giáº£i phÃ¡p       | Thá»i gian | KhÃ´ng gian |
| --------------- | --------- | ---------- |
| DP (O(1) space) | O(n)      | O(1)       |

***

## **ğŸ“Œ Tá»•ng káº¿t**

* DÃ¹ng **quy hoáº¡ch Ä‘á»™ng** Ä‘á»ƒ theo dÃµi `hold` vÃ  `cash`.
* **KhÃ´ng cáº§n máº£ng**, chá»‰ dÃ¹ng hai biáº¿n giÃºp giáº£m bá»™ nhá»› xuá»‘ng `O(1)`.
* ÄÃ¢y lÃ  giáº£i phÃ¡p **tá»‘i Æ°u** vá» cáº£ **tá»‘c Ä‘á»™ vÃ  bá»™ nhá»›**! ğŸš€
