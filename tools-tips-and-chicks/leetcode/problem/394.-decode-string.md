# 394. Decode String

## ‚ùì Problem

[https://leetcode.com/problems/decode-string](https://leetcode.com/problems/decode-string)

## **üìå M√¥ t·∫£ b√†i to√°n**

Cho m·ªôt chu·ªói ƒë∆∞·ª£c m√£ h√≥a theo d·∫°ng `"k[encoded_string]"`, trong ƒë√≥:

* `k` l√† s·ªë l·∫ßn l·∫∑p l·∫°i chu·ªói con b√™n trong `[ ]`.
* `encoded_string` c√≥ th·ªÉ ch·ª©a c√°c k√Ω t·ª± ch·ªØ c√°i (`a-z`), s·ªë (`0-9`), v√† c·∫£ c√°c bi·ªÉu th·ª©c l·ªìng nhau nh∆∞ `3[a2[c]]`.
* Y√™u c·∫ßu **gi·∫£i m√£ v√† tr·∫£ v·ªÅ chu·ªói k·∫øt qu·∫£**.

***

## **üí° V√≠ d·ª•**

#### ‚úÖ **V√≠ d·ª• 1**

```
Input: s = "3[a]2[bc]"
Output: "aaabcbc"
```

**Gi·∫£i th√≠ch:**

* `"3[a]"` ‚Üí `"aaa"`
* `"2[bc]"` ‚Üí `"bcbc"`
* K·∫øt qu·∫£: `"aaabcbc"`

***

#### ‚úÖ **V√≠ d·ª• 2**

```
Input: s = "3[a2[c]]"
Output: "accaccacc"
```

**Gi·∫£i th√≠ch:**

* `"2[c]"` ‚Üí `"cc"`
* `"3[a2[c]]"` ‚Üí `"accaccacc"`

***

#### ‚úÖ **V√≠ d·ª• 3**

```
Input: s = "2[abc]3[cd]ef"
Output: "abcabccdcdcdef"
```

**Gi·∫£i th√≠ch:**

* `"2[abc]"` ‚Üí `"abcabc"`
* `"3[cd]"` ‚Üí `"cdcdcd"`
* K·∫øt qu·∫£: `"abcabccdcdcdef"`

***

## **üöÄ Gi·∫£i ph√°p: D√πng Stack (`O(n)`)**

#### üìå **√ù t∆∞·ªüng ch√≠nh:**

* **D√πng stack ƒë·ªÉ x·ª≠ l√Ω bi·ªÉu th·ª©c l·ªìng nhau.**
* Khi g·∫∑p `]`, **gi·∫£i m√£ chu·ªói b√™n trong** v√† gh√©p v√†o ph·∫ßn tr∆∞·ªõc.
* Duy·ªát t·ª´ng k√Ω t·ª± trong chu·ªói `s`:
  * N·∫øu l√† **s·ªë (`0-9`)**, t√≠nh `k` (s·ªë l·∫ßn l·∫∑p).
  * N·∫øu l√† **ch·ªØ c√°i (`a-z`)**, th√™m v√†o stack.
  * N·∫øu l√† **`[`**, push `k` v√†o stack.
  * N·∫øu l√† **`]`**, pop stack ƒë·ªÉ l·∫•y chu·ªói con v√† s·ªë `k`, gi·∫£i m√£ v√† push l·∫°i.

***

## **üìú Code**

{% tabs %}
{% tab title="C++" %}
```cpp
class Solution {
public:
    string decodeString(string s) {
        stack<int> countStack;
        stack<string> stringStack;
        string currentString = "";
        int k = 0;

        for (char c : s) {
            if (isdigit(c)) {
                k = k * 10 + (c - '0');
            } else if (c == '[') {
                countStack.push(k);
                stringStack.push(currentString);
                currentString = "";
                k = 0;
            } else if (c == ']') {
                string decodedString = stringStack.top(); stringStack.pop();
                int repeatTimes = countStack.top(); countStack.pop();
                while (repeatTimes-- > 0) {
                    decodedString += currentString;
                }
                currentString = decodedString;
            } else {
                currentString += c;
            }
        }

        return currentString;
    }
};
```
{% endtab %}

{% tab title="Java" %}
```java
class Solution {
    public String decodeString(String s) {
        Stack<Integer> countStack = new Stack<>();
        Stack<StringBuilder> stringStack = new Stack<>();
        StringBuilder currentString = new StringBuilder();
        int k = 0;

        for (char c : s.toCharArray()) {
            if (Character.isDigit(c)) {
                k = k * 10 + (c - '0');  // X·ª≠ l√Ω s·ªë c√≥ nhi·ªÅu ch·ªØ s·ªë
            } else if (c == '[') {
                countStack.push(k);
                stringStack.push(currentString);
                currentString = new StringBuilder();
                k = 0;
            } else if (c == ']') {
                StringBuilder decodedString = stringStack.pop();
                int repeatTimes = countStack.pop();
                while (repeatTimes-- > 0) {
                    decodedString.append(currentString);
                }
                currentString = decodedString;
            } else {
                currentString.append(c);
            }
        }
        
        return currentString.toString();
    }
}
```
{% endtab %}

{% tab title="Python" %}
```python
class Solution:
    def decodeString(self, s: str) -> str:
        stack = []
        current_string = ""
        k = 0

        for c in s:
            if c.isdigit():
                k = k * 10 + int(c)
            elif c == '[':
                stack.append((current_string, k))
                current_string = ""
                k = 0
            elif c == ']':
                last_string, repeat_times = stack.pop()
                current_string = last_string + current_string * repeat_times
            else:
                current_string += c
        
        return current_string
```
{% endtab %}
{% endtabs %}

***

## **‚è≥ ƒê·ªô ph·ª©c t·∫°p thu·∫≠t to√°n**

| Ph∆∞∆°ng ph√°p             | Th·ªùi gian | Kh√¥ng gian |
| ----------------------- | --------- | ---------- |
| **D√πng Stack (`O(n)`)** | `O(n)`    | `O(n)`     |

‚úÖ **M·ªói k√Ω t·ª± ƒë∆∞·ª£c duy·ªát ƒë√∫ng 1 l·∫ßn (`O(n)`)**.\
‚úÖ **Stack gi√∫p x·ª≠ l√Ω l·ªìng nhau d·ªÖ d√†ng**.

***

## **üìå T·ªïng k·∫øt**

‚úî **D√πng stack ƒë·ªÉ l∆∞u tr·∫°ng th√°i tr∆∞·ªõc `[ ]`**.\
‚úî **Gi·∫£i m√£ t·ª´ng ph·∫ßn t·ª´ trong ra ngo√†i**.\
‚úî **Th·ªùi gian `O(n)`, t·ªëi ∆∞u h∆°n c√°c ph∆∞∆°ng ph√°p kh√°c**.
