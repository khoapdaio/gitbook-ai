# 901. Online Stock Span

## **â“ Problem:**&#x20;

[Leetcode: 901. Online Stock Span](https://leetcode.com/problems/online-stock-span)

## **ğŸ“ MÃ´ táº£:**

Báº¡n cáº§n thiáº¿t káº¿ má»™t há»‡ thá»‘ng giÃºp tÃ­nh **Stock Span**â€”sá»‘ ngÃ y liÃªn tiáº¿p trÆ°á»›c Ä‘Ã³ mÃ  giÃ¡ cá»• phiáº¿u khÃ´ng cao hÆ¡n ngÃ y hiá»‡n táº¡i.

Cáº§n triá»ƒn khai **class `StockSpanner`** vá»›i phÆ°Æ¡ng thá»©c:

* `int next(int price)`: Nháº­n vÃ o giÃ¡ cá»• phiáº¿u `price` vÃ  tráº£ vá» Stock Span tÆ°Æ¡ng á»©ng.

***

## **ğŸ’¡ VÃ­ dá»¥:**

#### âœ… **VÃ­ dá»¥ 1:**

**Input:**

```cpp
["StockSpanner", "next", "next", "next", "next", "next", "next", "next"]
[[], [100], [80], [60], [70], [60], [75], [85]]
```

**Output:**

```cpp
[null, 1, 1, 1, 2, 1, 4, 6]
```

**Giáº£i thÃ­ch:**

```
StockSpanner stockSpanner = new StockSpanner();
stockSpanner.next(100); // return 1
stockSpanner.next(80);  // return 1
stockSpanner.next(60);  // return 1
stockSpanner.next(70);  // return 2 (70 >= 60)
stockSpanner.next(60);  // return 1
stockSpanner.next(75);  // return 4 (75 >= 60, 70, 60)
stockSpanner.next(85);  // return 6 (85 >= 75, 60, 70, 60, 80)
```

***

## **ğŸš€ Giáº£i phÃ¡p: DÃ¹ng Stack (O(N) per query)**

**ğŸ’¡ Ã tÆ°á»Ÿng:**

* **DÃ¹ng Stack** Ä‘á»ƒ lÆ°u `(price, span)` giÃºp **tÃ­nh toÃ¡n nhanh sá»‘ ngÃ y liÃªn tiáº¿p**.
* Náº¿u giÃ¡ cá»• phiáº¿u hiá»‡n táº¡i **>= giÃ¡ trÃªn Ä‘á»‰nh Stack**, ta **pop** vÃ  cá»™ng dá»“n `span`.
* Stack luÃ´n chá»©a **giÃ¡ trá»‹ giáº£m dáº§n**, giÃºp truy xuáº¥t `span` nhanh hÆ¡n.

## **ğŸ“œ Code:**

{% tabs %}
{% tab title="C++" %}
```cpp
class StockSpanner {
public:
    stack<pair<int, int>> s;

    int next(int price) {
        int span = 1;
        while (!s.empty() && s.top().first <= price) {
            span += s.top().second;
            s.pop();
        }
        s.push({price, span});
        return span;
    }
};
```
{% endtab %}

{% tab title="Java" %}
```java
class StockSpanner {
    Stack<int[]> stack;

    public StockSpanner() {
        stack = new Stack<>();
    }

    public int next(int price) {
        int span = 1;
        while (!stack.isEmpty() && stack.peek()[0] <= price) {
            span += stack.pop()[1];
        }
        stack.push(new int[]{price, span});
        return span;
    }
}
```
{% endtab %}

{% tab title="Python" %}
```python
class StockSpanner:
    def __init__(self):
        self.stack = []

    def next(self, price: int) -> int:
        span = 1
        while self.stack and self.stack[-1][0] <= price:
            span += self.stack.pop()[1]
        self.stack.append((price, span))
        return span
```
{% endtab %}
{% endtabs %}

***

## **ğŸ¯ Äiá»ƒm chÃ­nh:**

âœ… **DÃ¹ng Stack giÃºp tá»‘i Æ°u truy xuáº¥t**: Stack giÃºp duy trÃ¬ thá»© tá»± giáº£m dáº§n vÃ  nhanh chÃ³ng láº¥y `span`.\
âœ… **KhÃ´ng cáº§n lÆ°u táº¥t cáº£ dá»¯ liá»‡u**: Chá»‰ giá»¯ láº¡i cÃ¡c giÃ¡ trá»‹ cáº§n thiáº¿t.\
âœ… **Má»—i pháº§n tá»­ vÃ o Stack chá»‰ bá»‹ `push` vÃ  `pop` duy nháº¥t má»™t láº§n**, giÃºp giáº£m Ä‘á»™ phá»©c táº¡p.

***

## **â³ Äá»™ phá»©c táº¡p thuáº­t toÃ¡n:**

* **Trung bÃ¬nh:** `O(1)` má»—i láº§n gá»i `next()`.
* **Tá»‡ nháº¥t:** `O(N)`, khi giÃ¡ cá»• phiáº¿u liÃªn tá»¥c tÄƒng.
* **KhÃ´ng gian:** `O(N)`, vÃ¬ cÃ³ thá»ƒ lÆ°u táº¥t cáº£ pháº§n tá»­ vÃ o Stack.

***

## **ğŸ“Œ Tá»•ng káº¿t:**

* **DÃ¹ng Stack** giÃºp xá»­ lÃ½ truy váº¥n nhanh chÃ³ng.
* **Má»—i giÃ¡ trá»‹ Ä‘Æ°á»£c xá»­ lÃ½ tá»‘i Ä‘a má»™t láº§n** nÃªn thá»i gian trung bÃ¬nh gáº§n `O(1)`.
* **Giáº£i phÃ¡p tá»‘i Æ°u cho bÃ i toÃ¡n yÃªu cáº§u xá»­ lÃ½ nhiá»u truy váº¥n liÃªn tiáº¿p**. ğŸš€
